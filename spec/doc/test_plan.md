# Test Plan

**Version: 1.0**

## Table of Contents

- [Version History](#version-history)
- [Introduction](#introduction)
- [Functional Testing](#functional-testing)
  - [Test Risks](#test-risks)
  - [Pass/Fail Criteria](#pass-fail-criteria)
  - [Test Deliverables](#test-deliverables)
  - [Environmental Requirements](#environmental-requirements)
  - [Test Cases](#test-cases)
- [Unit Testing](#unit-testing)
  - [Test Risks](#test-risks1)
  - [Pass/Fail Criteria](#pass-fail-criteria1)
  - [Test Deliverables](#test-deliverables1)
  - [Environmental Requirements](#environmental-requirements1)
  - [Test Cases](#test-cases1)


## Version History

| Version | Revision Date |              Description             |                Author              |
|---------|---------------|--------------------------------------|------------------------------------|
| 1.0     | 10/13/2016    | Test plan created                    | Nurfet Becirevic (StackPointCloud) |


## Introduction

This document describes the test plan for the OneAndOne Vagrant plugin.
The OneAndOne Vagrant provider has functional and unit tests that cover essential
Vagrant plugin functionality which is currently implemented.


## Functional Testing

The functional testing relies on test automation. It is performed in the form of Vagrant plugin 
acceptance testing which verifies whether the plugin can work with the entire Vagrant system correctly.
Vagrant's [vagrant-spec](https://github.com/mitchellh/vagrant-spec) library is used as a framework
for writing the tests. The library provides testing helpers suitable for writing unit and acceptance tests.
It enables treating Vagrant as a black box during the plugin testing.

### Test Risks

The functional tests for OneAndOne provider plugin are executed in real time using a valid 1&amp;1 user account.
This may temporarily affect the access to the other user's resources, if the request rate exceeds the limit.
Also, in case of a sudden failure such as the connection loss, it may leave uncleaned test resources tight to
the user's 1&amp;1 account.


### Pass/Fail Criteria

The functional tests pass criteria is passing all the test in the test suite executed in the following command:

    rake spec:acceptance

### Test Deliverables

For the functional testing, the deliverables include detailed testing logs as generated by a maintainer starting 
`rake spec:acceptance` task in the CLI when appropriate.

### Environmental Requirements

The Testing requires:

* A host capable of running Vagrant with Internet connectivity.
* An 1&amp;1 API access key set in $ONEANDONE_API_KEY environment variable.
* A development environment set up, as described in the user documentation.
* Vagrant may require `bsdtar` archiver to be installed for Vagrant box installation.

### Test Cases

| Test Case # | Functionality/Command/Action    | Expected Results                                | Pass/Fail |
|-------------|---------------------------------|-------------------------------------------------|-----------|
| 1           | vagrant box add                 | Installs OneAndOne provider box.                |    Pass   |
| 2           | vagrant up                      | Creates an instance.                            |    Pass   |
| 3           | vagrant up                      | First run provisions the instance.              |    Pass   |
| 4           | vagrant up                      | Starts a stopped instance.                      |    Pass   |
| 5           | vagrant status                  | Shows status of the instances.                  |    Pass   |
| 6           | vagrant destroy                 | Destroys an instance.                           |    Pass   |
| 7           | vagrant ssh-config              | It shows SSH configuration.                     |    Pass   |
| 8           | vagrant ssh                     | SSH connect into an instance.                   |    Pass   |
| 9           | vagrant ssh [ssh command]       | Runs SSH command on an instance.                |    Pass   |
| 10          | vagrant reload                  | Restarts an instance.                           |    Pass   |
| 11          | vagrant halt                    | Stops an instance.                              |    Pass   |
| 12          | vagrant provision               | Provisions an instance.                         |    Pass   |
| 13          | vagrant oneandone appliances    | Lists server appliances.                        |    Pass   |
| 14          | vagrant oneandone datacenters   | Lists data centers.                             |    Pass   |
| 15          | vagrant oneandone firewalls     | Lists firewall policies.                        |    Pass   |
| 16          | vagrant oneandone ips           | Lists public IPs.                               |    Pass   |
| 17          | vagrant oneandone loadbalancers | Lists load balancers.                           |    Pass   |
| 18          | vagrant oneandone monitors      | Lists monitoring policies.                      |    Pass   |
| 19          | vagrant oneandone servers       | Lists servers.                                  |    Pass   |
| 20          | vagrant oneandone sizes         | Lists fixed-server sizes.                       |    Pass   |


## Unit Testing

The unit testing utilizes test automation with RSpec test framework.

### <div id='test-risks1'/>Test Risks

None noted.

### <div id='pass-fail-criteria1'/>Pass/Fail Criteria

The unit tests pass criteria is passing all the test in the test suite executed in the following command:

    rake spec:unit

### <div id='test-deliverables1'/>Test Deliverables

For the unit testing, the deliverables include detailed testing logs as generated by the Travis CI job or a maintainer starting 
`rake spec:unit` task in the CLI when appropriate.

### <div id='environmental-requirements1'/>Environmental Requirements

The Testing requires:

* A host capable of running Vagrant.
* A development environment set up, as described in the user documentation.

### <div id='test-cases1'/>Test Cases

| Test Case # | Functionality/Command/Action           | Expected Results                                               | Pass/Fail |
|-------------|----------------------------------------|----------------------------------------------------------------|-----------|
| 1           | Provider name.                         | Provider should have the correct name.                         |    Pass   |
| 2           | Provider config defaults.              | Provider config attributes should have correct default values. |    Pass   |
| 3           | Overriding provider config.            | Provider config attributes should be overridable.              |    Pass   |
| 4           | Resolve server appliance with ID.      | It should verify server appliance when an ID is provided.      |    Pass   |
| 5           | Resolve server appliance with name.    | It should verify server appliance when a name is provided.     |    Pass   |
| 6           | Resolve fixed-server size with ID.     | It should verify fixed-server size when an ID is provided.     |    Pass   |
| 7           | Resolve fixed-server size with name.   | It should verify fixed-server size when a name is provided.    |    Pass   |
| 8           | Resolve data center with ID.           | It should verify data center when an ID is provided.           |    Pass   |
| 9           | Resolve data center with country code. | It should verify data center when a country code is provided.  |    Pass   |
| 10          | Resolve public IP with ID.             | It should verify public IP when an ID is provided.             |    Pass   |
| 11          | Resolve public IP with IP address.     | It should verify public IP when an IP address is provided.     |    Pass   |
| 12          | Verify SSH key.                        | It should verify that SSH key pair is provided.                |    Pass   |
| 13          | `vagrant up` action flow.              | It should have correct sub-action call sequence.               |    Pass   |
| 14          | `vagrant reload` action flow.          | It should have correct sub-action call sequence.               |    Pass   |
| 15          | `vagrant provision` action flow.       | It should have correct sub-action call sequence.               |    Pass   |
| 16          | `vagrant halt` action flow.            | It should have correct sub-action call sequence.               |    Pass   |
| 17          | `vagrant ssh-config` action flow.      | It should have correct sub-action call sequence.               |    Pass   |
| 18          | `vagrant ssh` action flow.             | It should have correct sub-action call sequence.               |    Pass   |
| 19          | `vagrant ssh run` action flow.         | It should have correct sub-action call sequence.               |    Pass   |
| 20          | `vagrant status` action flow.          | It should have correct sub-action call sequence.               |    Pass   |
| 21          | `vagrant destroy` action flow.         | It should have correct sub-action call sequence.               |    Pass   | 